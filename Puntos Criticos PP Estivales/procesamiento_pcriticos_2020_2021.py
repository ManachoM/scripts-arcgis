# -*- coding: cp1252 -*-

import arcpy
from string import Template

print 'Eliminando Registros Antiguos'

GDB_PATH = "E:\\scripts-arcgis\\sde\\PP_Estivales_P_Criticos_197.sde"
FC_COMPILADO = GDB_PATH + "\\p_criticos_pp_estivales.sde.Puntos_criticos"

arcpy.DeleteRows_management(FC_COMPILADO)

print 'Registros Antiguos Eliminados'

print 'Incorpora Registros Nuevos'

input_table = Template(
    "'$database_path\\p_criticos_pp_estivales.sde.Puntos_criticos_Antofagasta';'$database_path\\p_criticos_pp_estivales.sde.Puntos_criticos_Arica';'$database_path\\p_criticos_pp_estivales.sde.Puntos_criticos_Atacama';'$database_path\\p_criticos_pp_estivales.sde.Puntos_criticos_Tarapaca'"
).substitute(database_path = GDB_PATH)

field_mapping_text = Template(
    "region \"región\" true true false 70 Text 0 0 ,First,#,$database_path\\p_criticos_pp_estivales.sde.Puntos_criticos_Antofagasta,region,-1,-1,$database_path\\p_criticos_pp_estivales.sde.Puntos_criticos_Arica,region,-1,-1,$database_path\\p_criticos_pp_estivales.sde.Puntos_criticos_Atacama,region,-1,-1,$database_path\\p_criticos_pp_estivales.sde.Puntos_criticos_Tarapaca,region,-1,-1;provincia \"provincia\" true true false 70 Text 0 0 ,First,#,$database_path\\p_criticos_pp_estivales.sde.Puntos_criticos_Antofagasta,provincia,-1,-1,$database_path\\p_criticos_pp_estivales.sde.Puntos_criticos_Arica,provincia,-1,-1,$database_path\\p_criticos_pp_estivales.sde.Puntos_criticos_Atacama,provincia,-1,-1,$database_path\\p_criticos_pp_estivales.sde.Puntos_criticos_Tarapaca,provincia,-1,-1;comuna \"comuna\" true true false 70 Text 0 0 ,First,#,$database_path\\p_criticos_pp_estivales.sde.Puntos_criticos_Antofagasta,comuna,-1,-1,$database_path\\p_criticos_pp_estivales.sde.Puntos_criticos_Arica,comuna,-1,-1,$database_path\\p_criticos_pp_estivales.sde.Puntos_criticos_Atacama,comuna,-1,-1,$database_path\\p_criticos_pp_estivales.sde.Puntos_criticos_Tarapaca,comuna,-1,-1;sector \"sector\" true true false 254 Text 0 0 ,First,#,$database_path\\p_criticos_pp_estivales.sde.Puntos_criticos_Antofagasta,sector,-1,-1,$database_path\\p_criticos_pp_estivales.sde.Puntos_criticos_Arica,sector,-1,-1,$database_path\\p_criticos_pp_estivales.sde.Puntos_criticos_Atacama,sector,-1,-1,$database_path\\p_criticos_pp_estivales.sde.Puntos_criticos_Tarapaca,sector,-1,-1;responsable_info \"responsable_info\" true true false 254 Text 0 0 ,First,#,$database_path\\p_criticos_pp_estivales.sde.Puntos_criticos_Antofagasta,responsable_info,-1,-1,$database_path\\p_criticos_pp_estivales.sde.Puntos_criticos_Arica,responsable_info,-1,-1,$database_path\\p_criticos_pp_estivales.sde.Puntos_criticos_Atacama,responsable_info,-1,-1,$database_path\\p_criticos_pp_estivales.sde.Puntos_criticos_Tarapaca,responsable_info,-1,-1;causa_punto_critico \"causa_punto_critico\" true true false 50 Text 0 0 ,First,#,$database_path\\p_criticos_pp_estivales.sde.Puntos_criticos_Antofagasta,causa_punto_critico,-1,-1,$database_path\\p_criticos_pp_estivales.sde.Puntos_criticos_Arica,causa_punto_critico,-1,-1,$database_path\\p_criticos_pp_estivales.sde.Puntos_criticos_Atacama,causa_punto_critico,-1,-1,$database_path\\p_criticos_pp_estivales.sde.Puntos_criticos_Tarapaca,causa_punto_critico,-1,-1;nivel_de_riesgo \"nivel_de_riesgo\" true true false 50 Text 0 0 ,First,#,$database_path\\p_criticos_pp_estivales.sde.Puntos_criticos_Antofagasta,nivel_de_riesgo,-1,-1,$database_path\\p_criticos_pp_estivales.sde.Puntos_criticos_Arica,nivel_de_riesgo,-1,-1,$database_path\\p_criticos_pp_estivales.sde.Puntos_criticos_Atacama,nivel_de_riesgo,-1,-1,$database_path\\p_criticos_pp_estivales.sde.Puntos_criticos_Tarapaca,nivel_de_riesgo,-1,-1;nivel_de_riesgo_2020 \"nivel_de_riesgo\" true true false 50 Text 0 0 ,First,#,$database_path\\p_criticos_pp_estivales.sde.Puntos_criticos_Antofagasta,nivel_de_riesgo_2020,-1,-1,$database_path\\p_criticos_pp_estivales.sde.Puntos_criticos_Arica,nivel_de_riesgo_2020,-1,-1,$database_path\\p_criticos_pp_estivales.sde.Puntos_criticos_Atacama,nivel_de_riesgo_2020,-1,-1,$database_path\\p_criticos_pp_estivales.sde.Puntos_criticos_Tarapaca,nivel_de_riesgo_2020,-1,-1;punto_critico \"punto_critico\" true true false 50 Text 0 0 ,First,#,$database_path\\p_criticos_pp_estivales.sde.Puntos_criticos_Antofagasta,punto_critico,-1,-1,$database_path\\p_criticos_pp_estivales.sde.Puntos_criticos_Arica,punto_critico,-1,-1,$database_path\\p_criticos_pp_estivales.sde.Puntos_criticos_Atacama,punto_critico,-1,-1,$database_path\\p_criticos_pp_estivales.sde.Puntos_criticos_Tarapaca,punto_critico,-1,-1;globalid \"globalid\" false false false 38 GlobalID 0 0 ,First,#,$database_path\\p_criticos_pp_estivales.sde.Puntos_criticos_Antofagasta,globalid,-1,-1,$database_path\\p_criticos_pp_estivales.sde.Puntos_criticos_Arica,globalid,-1,-1,$database_path\\p_criticos_pp_estivales.sde.Puntos_criticos_Atacama,globalid,-1,-1,$database_path\\p_criticos_pp_estivales.sde.Puntos_criticos_Tarapaca,globalid,-1,-1;f1_acciones_mitigación \"acciones_mitigación\" true true false 50 Text 0 0 ,First,#,$database_path\\p_criticos_pp_estivales.sde.Puntos_criticos_Antofagasta,f1_acciones_mitigación,-1,-1,$database_path\\p_criticos_pp_estivales.sde.Puntos_criticos_Arica,f1_acciones_mitigación,-1,-1,$database_path\\p_criticos_pp_estivales.sde.Puntos_criticos_Atacama,f1_acciones_mitigación,-1,-1,$database_path\\p_criticos_pp_estivales.sde.Puntos_criticos_Tarapaca,f1_acciones_mitigación,-1,-1;f2_acciones_mitigación \"2_acciones_mitigación\" true true false 50 Text 0 0 ,First,#,$database_path\\p_criticos_pp_estivales.sde.Puntos_criticos_Antofagasta,f2_acciones_mitigación,-1,-1,$database_path\\p_criticos_pp_estivales.sde.Puntos_criticos_Arica,f2_acciones_mitigación,-1,-1,$database_path\\p_criticos_pp_estivales.sde.Puntos_criticos_Atacama,f2_acciones_mitigación,-1,-1,$database_path\\p_criticos_pp_estivales.sde.Puntos_criticos_Tarapaca,f2_acciones_mitigación,-1,-1;acciones_de_mitigacion \"acciones_de_mitigacion\" true true false 50 Text 0 0 ,First,#,$database_path\\p_criticos_pp_estivales.sde.Puntos_criticos_Antofagasta,acciones_de_mitigacion,-1,-1,$database_path\\p_criticos_pp_estivales.sde.Puntos_criticos_Arica,acciones_de_mitigacion,-1,-1,$database_path\\p_criticos_pp_estivales.sde.Puntos_criticos_Atacama,acciones_de_mitigacion,-1,-1,$database_path\\p_criticos_pp_estivales.sde.Puntos_criticos_Tarapaca,acciones_de_mitigacion,-1,-1;solucion_p_crit \"solucion_p_crit\" true true false 50 Text 0 0 ,First,#,$database_path\\p_criticos_pp_estivales.sde.Puntos_criticos_Antofagasta,solucion_p_crit,-1,-1,$database_path\\p_criticos_pp_estivales.sde.Puntos_criticos_Arica,solucion_p_crit,-1,-1,$database_path\\p_criticos_pp_estivales.sde.Puntos_criticos_Atacama,solucion_p_crit,-1,-1,$database_path\\p_criticos_pp_estivales.sde.Puntos_criticos_Tarapaca,solucion_p_crit,-1,-1;si_la_resp_es \"si_la_resp_es\" true true false 50 Text 0 0 ,First,#,$database_path\\p_criticos_pp_estivales.sde.Puntos_criticos_Antofagasta,si_la_resp_es,-1,-1,$database_path\\p_criticos_pp_estivales.sde.Puntos_criticos_Arica,si_la_resp_es,-1,-1,$database_path\\p_criticos_pp_estivales.sde.Puntos_criticos_Atacama,si_la_resp_es,-1,-1,$database_path\\p_criticos_pp_estivales.sde.Puntos_criticos_Tarapaca,si_la_resp_es,-1,-1"
).substitute(database_path = GDB_PATH)


arcpy.Append_management(
    input_table,
    target = FC_COMPILADO,
    schema_type = "NO_TEST",
    field_mapping = field_mapping_text,
    subtype = ""
)

print 'Registros Nuevos Incorporados'
print 'Procesamiento terminado'
