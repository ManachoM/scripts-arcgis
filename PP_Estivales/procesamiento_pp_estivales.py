#-*- coding: utf-8 -*-

import arcpy
from string import Template

print 'Eliminando Registros Antiguos'

GDB_PATH = "E:\\scripts-arcgis\\sde\\PP_Estivales_214.sde"
#GDB_PATH = "E:\\scripts-arcgis\\sde\\PP_Estivales_197.sde"
FC_COMPILADO = GDB_PATH + "\\estivales.sde.Actividades_preparacion"

arcpy.DeleteRows_management(FC_COMPILADO)

print 'Registros Antiguos Eliminados'

print 'Incorpora Registros Nuevos'

input_tables = Template(
    "'$database_path\\estivales.sde.Actividades_preparacion_Antofagasta';'$database_path\\estivales.sde.Actividades_preparacion_Arica';'$database_path\\estivales.sde.Actividades_preparacion_Atacama';'$database_path\\estivales.sde.Actividades_preparacion_Tarapaca'"
).substitute(database_path=GDB_PATH)

field_mapping_text = Template(
    "globalid \"globalid\" false false false 38 GlobalID 0 0 ,First,#,$database_path\\estivales.sde.Actividades_preparacion_Antofagasta,globalid,-1,-1,$database_path\\estivales.sde.Actividades_preparacion_Arica,globalid,-1,-1,$database_path\\estivales.sde.Actividades_preparacion_Atacama,globalid,-1,-1,$database_path\\estivales.sde.Actividades_preparacion_Tarapaca,globalid,-1,-1;region \"region\" true true false 60 Text 0 0 ,First,#,$database_path\\estivales.sde.Actividades_preparacion_Antofagasta,region,-1,-1,$database_path\\estivales.sde.Actividades_preparacion_Arica,region,-1,-1,$database_path\\estivales.sde.Actividades_preparacion_Atacama,region,-1,-1,$database_path\\estivales.sde.Actividades_preparacion_Tarapaca,region,-1,-1;provincia \"provincia\" true true false 60 Text 0 0 ,First,#,$database_path\\estivales.sde.Actividades_preparacion_Antofagasta,provincia,-1,-1,$database_path\\estivales.sde.Actividades_preparacion_Arica,provincia,-1,-1,$database_path\\estivales.sde.Actividades_preparacion_Atacama,provincia,-1,-1,$database_path\\estivales.sde.Actividades_preparacion_Tarapaca,provincia,-1,-1;comuna \"comuna\" true true false 60 Text 0 0 ,First,#,$database_path\\estivales.sde.Actividades_preparacion_Antofagasta,comuna,-1,-1,$database_path\\estivales.sde.Actividades_preparacion_Arica,comuna,-1,-1,$database_path\\estivales.sde.Actividades_preparacion_Atacama,comuna,-1,-1,$database_path\\estivales.sde.Actividades_preparacion_Tarapaca,comuna,-1,-1;reunion_cpcivl \"reunion cpcivl\" true true false 50 Text 0 0 ,First,#,$database_path\\estivales.sde.Actividades_preparacion_Antofagasta,reunion_cpcivl,-1,-1,$database_path\\estivales.sde.Actividades_preparacion_Arica,reunion_cpcivl,-1,-1,$database_path\\estivales.sde.Actividades_preparacion_Atacama,reunion_cpcivl,-1,-1,$database_path\\estivales.sde.Actividades_preparacion_Tarapaca,reunion_cpcivl,-1,-1;aplica_fdt_pc \"aplica_fdt_pc\" true true false 50 Text 0 0 ,First,#,$database_path\\estivales.sde.Actividades_preparacion_Antofagasta,aplica_fdt_pc,-1,-1,$database_path\\estivales.sde.Actividades_preparacion_Arica,aplica_fdt_pc,-1,-1,$database_path\\estivales.sde.Actividades_preparacion_Atacama,aplica_fdt_pc,-1,-1,$database_path\\estivales.sde.Actividades_preparacion_Tarapaca,aplica_fdt_pc,-1,-1;dis_plan_emeract \"dis_plan_emeract\" true true false 50 Text 0 0 ,First,#,$database_path\\estivales.sde.Actividades_preparacion_Antofagasta,dis_plan_emeract,-1,-1,$database_path\\estivales.sde.Actividades_preparacion_Arica,dis_plan_emeract,-1,-1,$database_path\\estivales.sde.Actividades_preparacion_Atacama,dis_plan_emeract,-1,-1,$database_path\\estivales.sde.Actividades_preparacion_Tarapaca,dis_plan_emeract,-1,-1;actuali_alberg \"Actuali_Alberg\" true true false 50 Text 0 0 ,First,#,$database_path\\estivales.sde.Actividades_preparacion_Antofagasta,actuali_alberg,-1,-1,$database_path\\estivales.sde.Actividades_preparacion_Arica,actuali_alberg,-1,-1,$database_path\\estivales.sde.Actividades_preparacion_Atacama,actuali_alberg,-1,-1,$database_path\\estivales.sde.Actividades_preparacion_Tarapaca,actuali_alberg,-1,-1;dis_entre_elememerg \"dis_entre_elememerg\" true true false 50 Text 0 0 ,First,#,$database_path\\estivales.sde.Actividades_preparacion_Antofagasta,dis_entre_elememerg,-1,-1,$database_path\\estivales.sde.Actividades_preparacion_Arica,dis_entre_elememerg,-1,-1,$database_path\\estivales.sde.Actividades_preparacion_Atacama,dis_entre_elememerg,-1,-1,$database_path\\estivales.sde.Actividades_preparacion_Tarapaca,dis_entre_elememerg,-1,-1;reali_csensi \"reali_csensi\" true true false 50 Text 0 0 ,First,#,$database_path\\estivales.sde.Actividades_preparacion_Antofagasta,reali_csensi,-1,-1,$database_path\\estivales.sde.Actividades_preparacion_Arica,reali_csensi,-1,-1,$database_path\\estivales.sde.Actividades_preparacion_Atacama,reali_csensi,-1,-1,$database_path\\estivales.sde.Actividades_preparacion_Tarapaca,reali_csensi,-1,-1;email \"email\" true true false 254 Text 0 0 ,First,#,$database_path\\estivales.sde.Actividades_preparacion_Antofagasta,email,-1,-1,$database_path\\estivales.sde.Actividades_preparacion_Arica,email,-1,-1,$database_path\\estivales.sde.Actividades_preparacion_Atacama,email,-1,-1,$database_path\\estivales.sde.Actividades_preparacion_Tarapaca,email,-1,-1;fono \"fono\" true true false 50 Text 0 0 ,First,#,$database_path\\estivales.sde.Actividades_preparacion_Antofagasta,fono,-1,-1,$database_path\\estivales.sde.Actividades_preparacion_Arica,fono,-1,-1,$database_path\\estivales.sde.Actividades_preparacion_Atacama,fono,-1,-1,$database_path\\estivales.sde.Actividades_preparacion_Tarapaca,fono,-1,-1;nombre_registra \"nombre_registra\" true true false 100 Text 0 0 ,First,#,$database_path\\estivales.sde.Actividades_preparacion_Antofagasta,nombre_registra,-1,-1,$database_path\\estivales.sde.Actividades_preparacion_Arica,nombre_registra,-1,-1,$database_path\\estivales.sde.Actividades_preparacion_Atacama,nombre_registra,-1,-1,$database_path\\estivales.sde.Actividades_preparacion_Tarapaca,nombre_registra,-1,-1;st_area_shape_ \"st_area_shape_\" true false false 8 Double 8 38 ,First,#,$database_path\\estivales.sde.Actividades_preparacion_Antofagasta,st_area_shape_,-1,-1,$database_path\\estivales.sde.Actividades_preparacion_Arica,st_area_shape_,-1,-1,$database_path\\estivales.sde.Actividades_preparacion_Atacama,st_area_shape_,-1,-1,$database_path\\estivales.sde.Actividades_preparacion_Tarapaca,st_area_shape_,-1,-1;st_length_shape_ \"st_length_shape_\" true false false 8 Double 8 38 ,First,#,$database_path\\estivales.sde.Actividades_preparacion_Antofagasta,st_length_shape_,-1,-1,$database_path\\estivales.sde.Actividades_preparacion_Arica,st_length_shape_,-1,-1,$database_path\\estivales.sde.Actividades_preparacion_Atacama,st_length_shape_,-1,-1,$database_path\\estivales.sde.Actividades_preparacion_Tarapaca,st_length_shape_,-1,-1;st_area_shape1 \"st_area_shape1\" true false false 8 Double 8 38 ,First,#;st_length_shape1 \"st_length_shape1\" true false false 8 Double 8 38 ,First,#;st_area(shape) \"st_area(shape)\" false false true 0 Double 0 0 ,First,#,$database_path\\estivales.sde.Actividades_preparacion_Antofagasta,st_area(shape),-1,-1,$database_path\\estivales.sde.Actividades_preparacion_Arica,st_area(shape),-1,-1,$database_path\\estivales.sde.Actividades_preparacion_Atacama,st_area(shape),-1,-1,$database_path\\estivales.sde.Actividades_preparacion_Tarapaca,st_area(shape),-1,-1;st_length(shape) \"st_length(shape)\" false false true 0 Double 0 0 ,First,#,$database_path\\estivales.sde.Actividades_preparacion_Antofagasta,st_length(shape),-1,-1,$database_path\\estivales.sde.Actividades_preparacion_Arica,st_length(shape),-1,-1,$database_path\\estivales.sde.Actividades_preparacion_Atacama,st_length(shape),-1,-1,$database_path\\estivales.sde.Actividades_preparacion_Tarapaca,st_length(shape),-1,-1"
).substitute(database_path = GDB_PATH)

arcpy.Append_management(
    input_tables,
    target = FC_COMPILADO,
    schema_type = "NO_TEST",
    field_mapping = field_mapping_text,
    subtype = ""
)

print 'Registros Nuevos Incorporados'
print 'Procesamiento terminado'
