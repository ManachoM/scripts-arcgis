# -*- coding: utf-8 -*-
# ---------------------------------------------------------------------------

# Import arcpy module
import arcpy
from string import Template

print 'Elimina registros antiguos'

GDB_SDE_P_CRITICOS_PP_INVIERNO = 'E:\\scripts-arcgis\\sde\\PP_Invierno_P_Critico_214.sde'
#GDB_SDE_P_CRITICOS_PP_INVIERNO = 'E:\\scripts-arcgis\\sde\\PP_Invierno_P_Critico_197.sde'
FC_COMPILADO = GDB_SDE_P_CRITICOS_PP_INVIERNO + '\\p_criticos_pp_invierno.sde.Compilado'

# Process: Delete Rows
arcpy.DeleteRows_management(FC_COMPILADO)

print 'Registros Eliminados'
print'Incorporando Registros Nuevos'

# Process: Append
# Append_management (inputs, target, {schema_type}, {field_mapping}, {subtype})

input_tables = Template("'$database_path\\p_criticos_pp_invierno.sde.Antofagasta';'$database_path\\p_criticos_pp_invierno.sde.Araucania';'$database_path\\p_criticos_pp_invierno.sde.Atacama';'$database_path\\p_criticos_pp_invierno.sde.Aysen';'$database_path\\p_criticos_pp_invierno.sde.Biobio';'$database_path\\p_criticos_pp_invierno.sde.Coquimbo';'$database_path\\p_criticos_pp_invierno.sde.Los_Lagos';'$database_path\\p_criticos_pp_invierno.sde.Valparaiso';'$database_path\\p_criticos_pp_invierno.sde.OHiggins';'$database_path\\p_criticos_pp_invierno.sde.Nuble';'$database_path\\p_criticos_pp_invierno.sde.Metropolitana';'$database_path\\p_criticos_pp_invierno.sde.Maule';'$database_path\\p_criticos_pp_invierno.sde.Magallanes';'$database_path\\p_criticos_pp_invierno.sde.Los_Rios'").substitute(database_path=GDB_SDE_P_CRITICOS_PP_INVIERNO)

field_mapping_text = Template(
    "objectid \"objectid\" true true false 4 Long 0 10 ,First,#,$database_path\\p_criticos_pp_invierno.sde.Araucania,objectid,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Atacama,objectid,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Aysen,objectid,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Biobio,objectid,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Coquimbo,objectid,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Los_Lagos,objectid,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Valparaiso,objectid,-1,-1,$database_path\\p_criticos_pp_invierno.sde.OHiggins,objectid,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Nuble,objectid,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Metropolitana,objectid,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Maule,objectid,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Magallanes,objectid,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Los_Rios,objectid,-1,-1;region \"region\" true true false 70 Text 0 0 ,First,#,$database_path\\p_criticos_pp_invierno.sde.Antofagasta,region,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Araucania,region,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Atacama,region,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Aysen,region,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Biobio,region,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Coquimbo,region,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Los_Lagos,region,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Valparaiso,region,-1,-1,$database_path\\p_criticos_pp_invierno.sde.OHiggins,region,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Nuble,region,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Metropolitana,region,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Maule,region,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Magallanes,region,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Los_Rios,region,-1,-1;provincia \"provincia\" true true false 70 Text 0 0 ,First,#,$database_path\\p_criticos_pp_invierno.sde.Antofagasta,provincia,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Araucania,provincia,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Atacama,provincia,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Aysen,provincia,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Biobio,provincia,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Coquimbo,provincia,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Los_Lagos,provincia,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Valparaiso,provincia,-1,-1,$database_path\\p_criticos_pp_invierno.sde.OHiggins,provincia,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Nuble,provincia,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Metropolitana,provincia,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Maule,provincia,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Magallanes,provincia,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Los_Rios,provincia,-1,-1;comuna \"comuna\" true true false 70 Text 0 0 ,First,#,$database_path\\p_criticos_pp_invierno.sde.Antofagasta,comuna,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Araucania,comuna,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Atacama,comuna,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Aysen,comuna,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Biobio,comuna,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Coquimbo,comuna,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Los_Lagos,comuna,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Valparaiso,comuna,-1,-1,$database_path\\p_criticos_pp_invierno.sde.OHiggins,comuna,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Nuble,comuna,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Metropolitana,comuna,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Maule,comuna,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Magallanes,comuna,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Los_Rios,comuna,-1,-1;sector \"sector\" true true false 254 Text 0 0 ,First,#,$database_path\\p_criticos_pp_invierno.sde.Antofagasta,sector,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Araucania,sector,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Atacama,sector,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Aysen,sector,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Biobio,sector,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Coquimbo,sector,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Los_Lagos,sector,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Valparaiso,sector,-1,-1,$database_path\\p_criticos_pp_invierno.sde.OHiggins,sector,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Nuble,sector,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Metropolitana,sector,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Maule,sector,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Magallanes,sector,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Los_Rios,sector,-1,-1;responsabl \"responsabl\" true true false 254 Text 0 0 ,First,#,$database_path\\p_criticos_pp_invierno.sde.Araucania,responsabl,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Atacama,responsabl,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Aysen,responsabl,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Biobio,responsabl,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Coquimbo,responsabl,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Los_Lagos,responsabl,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Valparaiso,responsabl,-1,-1,$database_path\\p_criticos_pp_invierno.sde.OHiggins,responsabl,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Nuble,responsabl,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Metropolitana,responsabl,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Maule,responsabl,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Magallanes,responsabl,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Los_Rios,responsabl,-1,-1;causa_punt \"causa_punt\" true true false 100 Text 0 0 ,First,#,$database_path\\p_criticos_pp_invierno.sde.Araucania,causa_punt,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Atacama,causa_punt,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Aysen,causa_punt,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Biobio,causa_punt,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Coquimbo,causa_punt,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Los_Lagos,causa_punt,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Valparaiso,causa_punt,-1,-1,$database_path\\p_criticos_pp_invierno.sde.OHiggins,causa_punt,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Nuble,causa_punt,-1,-1,$database_path\p_criticos_pp_invierno.sde.Metropolitana,causa_punt,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Maule,causa_punt,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Magallanes,causa_punt,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Los_Rios,causa_punt,-1,-1;nivel_de_r \"nivel_de_r\" true true false 50 Text 0 0 ,First,#,$database_path\\p_criticos_pp_invierno.sde.Araucania,nivel_de_r,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Atacama,nivel_de_r,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Aysen,nivel_de_r,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Biobio,nivel_de_r,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Coquimbo,nivel_de_r,-1,-1,$database_path\p_criticos_pp_invierno.sde.Los_Lagos,nivel_de_r,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Valparaiso,nivel_de_r,-1,-1,$database_path\\p_criticos_pp_invierno.sde.OHiggins,nivel_de_r,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Nuble,nivel_de_r,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Metropolitana,nivel_de_r,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Maule,nivel_de_r,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Magallanes,nivel_de_r,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Los_Rios,nivel_de_r,-1,-1;punto_crit \"punto_crit\" true true false 50 Text 0 0 ,First,#,$database_path\\p_criticos_pp_invierno.sde.Araucania,punto_crit,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Atacama,punto_crit,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Aysen,punto_crit,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Biobio,punto_crit,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Coquimbo,punto_crit,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Los_Lagos,punto_crit,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Valparaiso,punto_crit,-1,-1,$database_path\\p_criticos_pp_invierno.sde.OHiggins,punto_crit,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Nuble,punto_crit,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Metropolitana,punto_crit,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Maule,punto_crit,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Magallanes,punto_crit,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Los_Rios,punto_crit,-1,-1;globalid \"globalid\" true true false 38 Text 0 0 ,First,#,$database_path\\p_criticos_pp_invierno.sde.Antofagasta,globalid,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Araucania,globalid,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Atacama,globalid,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Aysen,globalid,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Biobio,globalid,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Coquimbo,globalid,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Los_Lagos,globalid,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Valparaiso,globalid,-1,-1,$database_path\\p_criticos_pp_invierno.sde.OHiggins,globalid,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Nuble,globalid,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Metropolitana,globalid,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Maule,globalid,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Magallanes,globalid,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Los_Rios,globalid,-1,-1;f1_accione \"f1_accione\" true true false 100 Text 0 0 ,First,#,$database_path\\p_criticos_pp_invierno.sde.Araucania,f1_accione,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Atacama,f1_accione,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Aysen,f1_accione,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Biobio,f1_accione,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Coquimbo,f1_accione,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Los_Lagos,f1_accione,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Valparaiso,f1_accione,-1,-1,$database_path\\p_criticos_pp_invierno.sde.OHiggins,f1_accione,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Nuble,f1_accione,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Metropolitana,f1_accione,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Maule,f1_accione,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Magallanes,f1_accione,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Los_Rios,f1_accione,-1,-1;f2_accione \"f2_accione\" true true false 100 Text 0 0 ,First,#,$database_path\\p_criticos_pp_invierno.sde.Araucania,f2_accione,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Atacama,f2_accione,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Aysen,f2_accione,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Biobio,f2_accione,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Coquimbo,f2_accione,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Los_Lagos,f2_accione,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Valparaiso,f2_accione,-1,-1,$database_path\\p_criticos_pp_invierno.sde.OHiggins,f2_accione,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Nuble,f2_accione,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Metropolitana,f2_accione,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Maule,f2_accione,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Magallanes,f2_accione,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Los_Rios,f2_accione,-1,-1;acciones_d \"acciones_d\" true true false 50 Text 0 0 ,First,#,$database_path\\p_criticos_pp_invierno.sde.Araucania,acciones_d,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Atacama,acciones_d,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Aysen,acciones_d,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Biobio,acciones_d,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Coquimbo,acciones_d,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Los_Lagos,acciones_d,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Valparaiso,acciones_d,-1,-1,$database_path\\p_criticos_pp_invierno.sde.OHiggins,acciones_d,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Nuble,acciones_d,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Metropolitana,acciones_d,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Maule,acciones_d,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Magallanes,acciones_d,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Los_Rios,acciones_d,-1,-1;solucion_p \"solucion_p\" true true false 100 Text 0 0 ,First,#,$database_path\\p_criticos_pp_invierno.sde.Araucania,solucion_p,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Atacama,solucion_p,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Aysen,solucion_p,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Biobio,solucion_p,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Coquimbo,solucion_p,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Los_Lagos,solucion_p,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Valparaiso,solucion_p,-1,-1,$database_path\\p_criticos_pp_invierno.sde.OHiggins,solucion_p,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Nuble,solucion_p,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Metropolitana,solucion_p,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Maule,solucion_p,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Magallanes,solucion_p,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Los_Rios,solucion_p,-1,-1;nivel_de_riesgo_2020 \"nivel_de_riesgo_2020\" true true false 100 Text 0 0 ,First,#,$database_path\\p_criticos_pp_invierno.sde.Araucania,nivel_de_riesgo_2020,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Atacama,nivel_de_riesgo_2020,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Aysen,nivel_de_riesgo_2020,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Biobio,nivel_de_riesgo_2020,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Coquimbo,nivel_de_riesgo_2020,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Los_Lagos,nivel_de_riesgo_2020,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Valparaiso,nivel_de_riesgo_2020,-1,-1,$database_path\\p_criticos_pp_invierno.sde.OHiggins,nivel_de_riesgo_2020,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Nuble,nivel_de_riesgo_2020,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Metropolitana,nivel_de_riesgo_2020,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Maule,nivel_de_riesgo_2020,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Magallanes,nivel_de_riesgo_2020,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Los_Rios,nivel_de_riesgo_2020,-1,-1;si_la_resp \"si_la_resp\" true true false 100 Text 0 0 ,First,#,$database_path\\p_criticos_pp_invierno.sde.Araucania,si_la_resp,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Atacama,si_la_resp,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Aysen,si_la_resp,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Biobio,si_la_resp,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Coquimbo,si_la_resp,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Los_Lagos,si_la_resp,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Valparaiso,si_la_resp,-1,-1,$database_path\\p_criticos_pp_invierno.sde.OHiggins,si_la_resp,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Nuble,si_la_resp,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Metropolitana,si_la_resp,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Maule,si_la_resp,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Magallanes,si_la_resp,-1,-1,$database_path\\p_criticos_pp_invierno.sde.Los_Rios,si_la_resp,-1,-1"
).substitute(database_path=GDB_SDE_P_CRITICOS_PP_INVIERNO)

arcpy.Append_management(
    input_tables,
    target=FC_COMPILADO,
    schema_type="NO_TEST",
    field_mapping=field_mapping_text,
    subtype=""
)

print 'Registros Nuevos Incorporados'
print 'procesamiento Terminado'
